<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <title>Analyseur de sondage PDF</title>

    <!-- PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc =
            'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { font-family: Arial, sans-serif; background: #f4f6f8; padding: 40px; }
        h1, h2 { text-align: center; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,.1); }
        .block { margin-bottom: 25px; }
        textarea { width: 100%; height: 90px; padding: 10px; }
        button { background: #007bff; color: white; padding: 10px 18px; border: none; border-radius: 5px; cursor: pointer; margin-right: 10px; }
        .results { display: flex; justify-content: space-around; margin-top: 30px; }
        .card { background: #f1f3f5; padding: 20px; border-radius: 8px; width: 22%; text-align: center; }
        canvas { max-width: 400px; margin: 30px auto; display: block; }
    </style>
</head>
<body>

<div class="container">
    <h1>Analyse de sondage ‚Äì Maisons closes</h1>

    <div class="block">
        <h3>1Ô∏è‚É£ Importer le fichier PDF</h3>
        <input type="file" id="pdfInput" accept="application/pdf" />
    </div>

    <div class="block">
        <h3>2Ô∏è‚É£ Mots-cl√©s POUR</h3>
        <textarea id="pourKeywords"></textarea>
    </div>

    <div class="block">
        <h3>3Ô∏è‚É£ Mots-cl√©s POUR SOUS CONDITIONS</h3>
        <textarea id="conditionalKeywords"></textarea>
    </div>

    <div class="block">
        <h3>4Ô∏è‚É£ Mots-cl√©s CONTRE</h3>
        <textarea id="contreKeywords"></textarea>
    </div>

    <div class="block">
        <button onclick="analyze()">üìä Lancer l‚Äôanalyse</button>
        <button onclick="resetKeywords()">üîÑ R√©initialiser</button>
    </div>

    <h2>üë• Personnes analys√©es : <span id="count">0</span></h2>

    <div class="results">
        <div class="card"><h3>‚úÖ POUR</h3><p id="pourResult">0 %</p></div>
        <div class="card"><h3>üü¶ POUR (conditions)</h3><p id="conditionalResult">0 %</p></div>
        <div class="card"><h3>‚ùå CONTRE</h3><p id="contreResult">0 %</p></div>
        <div class="card"><h3>‚öñÔ∏è NEUTRE</h3><p id="neutralResult">0 %</p></div>
    </div>

    <canvas id="chart"></canvas>
</div>

<script>
/* =========================
   KEYWORDS STATE
========================= */
let keywords = {
    pour: [],
    conditional: ["a condition", "sous condition", "mais", "si"],
    contre: []
};

/* =========================
   LOAD keyword.json
========================= */
